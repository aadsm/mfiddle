montageDefine("280061e","deserialization/reviver",{dependencies:["q"],factory:function(t,e){(function(e){function n(){}function a(t){var e=n.prototype.getCustomObjectTypeOf;return function(n){return t(n)||e(n)}}var i=function(){return this}(),r=t("q");Object.defineProperties(n.prototype,{_createAssignValueFunction:{value:function(t,e){return function(n){t[e]=n}}},getTypeOf:{value:function(t){var e=typeof t;return null===t?"null":Array.isArray(t)?"array":"object"===e&&1===Object.keys(t).length?"@"in t?"reference":"/"in t?"regexp":"object":e}},getCustomObjectTypeOf:{writable:!0,value:function(){}},reviveRootObject:{value:function(t,e,n){var a;return t.debugger,"value"in t?e.hasUserObject(n)?(a=e.getUserObject(n),e.setObjectLabel(a,n),a):this.reviveValue(t.value,e,n):0===Object.keys(t).length?e.hasUserObject(n)?(a=e.getUserObject(n),e.setObjectLabel(a,n),a):this.reviveExternalObject(t,e,n):this.reviveCustomObject(t,e,n)}},reviveValue:{value:function(t,e,n){var a=this.getTypeOf(t);return"string"===a||"number"===a||"boolean"===a||"null"===a||"undefined"===a?this.reviveNativeValue(t,e,n):"regexp"===a?this.reviveRegExp(t,e,n):"reference"===a?this.reviveObjectReference(t,e,n):"array"===a?this.reviveArray(t,e,n):"object"===a?this.reviveObjectLiteral(t,e,n):this._callReviveMethod("revive"+a,t,e,n)}},reviveNativeValue:{value:function(t,e,n){return n&&e.setObjectLabel(t,n),t}},reviveObjectLiteral:{value:function(t,e,n){var a,i=[];n&&e.setObjectLabel(t,n);for(var s in t)a=this.reviveValue(t[s],e),r.isPromise(a)?i.push(a.then(this._createAssignValueFunction(t,s))):t[s]=a;return 0===i.length?t:r.all(i).then(function(){return t})}},reviveRegExp:{value:function(t,e,n){var t=t["/"],a=RegExp(t.source,t.flags);return n&&e.setObjectLabel(a,n),a}},reviveObjectReference:{value:function(t,e){var t=t["@"],n=e.getObject(t);return n}},reviveArray:{value:function(t,e,n){var a,i=[];n&&e.setObjectLabel(t,n);for(var s=0,o=t.length;o>s;s++)a=this.reviveValue(t[s],e),r.isPromise(a)?i.push(a.then(this._createAssignValueFunction(t,s))):t[s]=a;return 0===i.length?t:r.all(i).then(function(){return t})}},reviveCustomObject:{value:function(t,e,n){var a=this.getCustomObjectTypeOf(t),o=s["revive"+a];return a?o.call(i,t,e,n):r.reject(Error("Object's type is unknown: "+JSON.stringify(t)))}},reviveExternalObject:{value:function(t,e,n){return r.reject(Error("External object '"+n+"' not found in user objects."))}},_callReviveMethod:{value:function(t,e,n,a){return this[t](e,n,a)}}});var s=Object.create(null);n.addCustomObjectReviver=function(t){for(var e in t)if("getTypeOf"!==e&&"function"==typeof t[e]&&/^revive/.test(e)){if(void 0!==s[e])return Error("Reviver '"+e+"' is already registered.");s[e]=t[e].bind(t)}this.prototype.getCustomObjectTypeOf=a(t.getTypeOf)},n.resetCustomObjectRevivers=function(){s=Object.create(null),this.prototype.getCustomObjectTypeOf=function(){}},e.Reviver=n})(e),Array.isArray||(Array.isArray=function(t){return"[object Array]"===Object.prototype.toString.call(t)})}});
(function(t){if("function"==typeof bootstrap)bootstrap("promise",t);else if("object"==typeof exports)module.exports=t();else if("function"==typeof define&&define.amd)define(t);else if("undefined"!=typeof ses){if(!ses.ok())return;ses.makeQ=t}else Q=t()})(function(){"use strict";function t(t){var e=Function.call;return function(){return e.apply(t,arguments)}}function e(t){return t===Object(t)}function n(t){return"[object StopIteration]"===Le(t)||t instanceof le}function i(t,e){if(ae&&e.stack&&"object"==typeof t&&null!==t&&t.stack&&-1===t.stack.indexOf(Ce)){for(var n=[],i=e;i;i=i.source)i.stack&&n.unshift(i.stack);n.unshift(t.stack);var r=n.join("\n"+Ce+"\n");t.stack=a(r)}}function a(t){for(var e=t.split("\n"),n=[],i=0;e.length>i;++i){var a=e[i];l(a)||r(a)||!a||n.push(a)}return n.join("\n")}function r(t){return-1!==t.indexOf("(module.js:")||-1!==t.indexOf("(node.js:")}function s(t){var e=/at .+ \((.+):(\d+):(?:\d+)\)$/.exec(t);if(e)return[e[1],Number(e[2])];var n=/at ([^ ]+):(\d+):(?:\d+)$/.exec(t);if(n)return[n[1],Number(n[2])];var i=/.*@(.+):(\d+)$/.exec(t);return i?[i[1],Number(i[2])]:void 0}function l(t){var e=s(t);if(!e)return!1;var n=e[0],i=e[1];return n===se&&i>=oe&&ze>=i}function o(){if(ae)try{throw Error()}catch(t){var e=t.stack.split("\n"),n=e[0].indexOf("@")>0?e[1]:e[2],i=s(n);if(!i)return;return se=i[0],i[1]}}function c(t,e,n){return function(){return"undefined"!=typeof console&&"function"==typeof console.warn&&console.warn(e+" is deprecated, use "+n+" instead.",Error("").stack),t.apply(t,arguments)}}function h(t){return S(t)}function u(){function t(t){e=t,r.source=t,de(n,function(e,n){he(function(){t.promiseDispatch.apply(t,n)})},void 0),n=void 0,i=void 0}var e,n=[],i=[],a=me(u.prototype),r=me(p.prototype);if(r.promiseDispatch=function(t,a,r){var s=ue(arguments);n?(n.push(s),"when"===a&&r[1]&&i.push(r[1])):he(function(){e.promiseDispatch.apply(e,s)})},r.valueOf=c(function(){if(n)return r;var t=g(e);return m(t)&&(e=t),t},"valueOf","inspect"),r.inspect=function(){return e?e.inspect():{state:"pending"}},h.longStackSupport&&ae)try{throw Error()}catch(s){r.stack=s.stack.substring(s.stack.indexOf("\n")+1)}return a.promise=r,a.resolve=function(n){e||t(S(n))},a.fulfill=function(n){e||t(z(n))},a.reject=function(n){e||t(x(n))},a.notify=function(t){e||de(i,function(e,n){he(function(){n(t)})},void 0)},a}function d(t){if("function"!=typeof t)throw new TypeError("resolver must be a function.");var e=u();return F(t,e.resolve,e.reject,e.notify).fail(e.reject),e.promise}function p(t,e,n){void 0===e&&(e=function(t){return x(Error("Promise does not support operation: "+t))}),void 0===n&&(n=function(){return{state:"unknown"}});var i=me(p.prototype);if(i.promiseDispatch=function(n,a,r){var s;try{s=t[a]?t[a].apply(i,r):e.call(i,a,r)}catch(l){s=x(l)}n&&n(s)},i.inspect=n,n){var a=n();"rejected"===a.state&&(i.exception=a.reason),i.valueOf=c(function(){var t=n();return"pending"===t.state||"rejected"===t.state?i:t.value})}return i}function g(t){if(m(t)){var e=t.inspect();if("fulfilled"===e.state)return e.value}return t}function m(t){return e(t)&&"function"==typeof t.promiseDispatch&&"function"==typeof t.inspect}function v(t){return e(t)&&"function"==typeof t.then}function f(t){return m(t)&&"pending"===t.inspect().state}function L(t){return!m(t)||"fulfilled"===t.inspect().state}function _(t){return m(t)&&"rejected"===t.inspect().state}function C(){Me||"undefined"==typeof window||window.Touch||!window.console||console.warn("[Q] Unhandled rejection reasons (should be empty):",we),Me=!0}function w(){for(var t=0;we.length>t;t++){var e=we[t];e&&e.stack!==void 0?console.warn("Unhandled rejection reason:",e.stack):console.warn("Unhandled rejection reason (no stack):",e)}}function y(){we.length=0,ye.length=0,Me=!1,be||(be=!0,"undefined"!=typeof process&&process.on&&process.on("exit",w))}function M(t,e){be&&(ye.push(t),we.push(e),C())}function b(t){if(be){var e=pe(ye,t);-1!==e&&(ye.splice(e,1),we.splice(e,1))}}function x(t){var e=p({when:function(e){return e&&b(this),e?e(t):this}},function(){return this},function(){return{state:"rejected",reason:t}});return M(e,t),e}function z(t){return p({when:function(){return t},get:function(e){return t[e]},set:function(e,n){t[e]=n},"delete":function(e){delete t[e]},post:function(e,n){return null===e||void 0===e?t.apply(void 0,n):t[e].apply(t,n)},apply:function(e,n){return t.apply(e,n)},keys:function(){return fe(t)}},void 0,function(){return{state:"fulfilled",value:t}})}function S(t){return m(t)?t:v(t)?E(t):z(t)}function E(t){var e=u();return he(function(){try{t.then(e.resolve,e.reject,e.notify)}catch(n){e.reject(n)}}),e.promise}function T(t){return p({isDef:function(){}},function(e,n){return I(t,e,n)},function(){return S(t).inspect()})}function P(t,e,n,i){return h(t).then(e,n,i)}function D(t,e,n){return P(t,function(t){return V(t).then(function(t){return e.apply(void 0,t)},n)},n)}function B(t){return function(){function e(t,e){var s;if(_e){try{s=i[t](e)}catch(l){return x(l)}return s.done?s.value:P(s.value,a,r)}try{s=i[t](e)}catch(l){return n(l)?l.value:x(l)}return P(s,a,r)}var i=t.apply(this,arguments),a=e.bind(e,"send"),r=e.bind(e,"throw");return a()}}function k(t){h.done(h.async(t)())}function O(t){throw new le(t)}function A(t){return function(){return D([this,V(arguments)],function(e,n){return t.apply(e,n)})}}function I(t,e,n){var i=u();return he(function(){S(t).promiseDispatch(i.resolve,e,n)}),i.promise}function j(t){return function(e){var n=ue(arguments,1);return I(e,t,n)}}function R(t,e){var n=ue(arguments,2);return xe(t,e,n)}function N(t,e){return I(t,"apply",[void 0,e])}function F(t){var e=ue(arguments,1);return N(t,e)}function q(t){var e=ue(arguments,1);return function(){var n=e.concat(ue(arguments));return I(t,"apply",[this,n])}}function V(t){return P(t,function(t){var e=0,n=u();return de(t,function(i,a,r){var s;m(a)&&"fulfilled"===(s=a.inspect()).state?t[r]=s.value:(++e,P(a,function(i){t[r]=i,0===--e&&n.resolve(t)},n.reject))},void 0),0===e&&n.resolve(t),n.promise})}function W(t){return P(t,function(t){return t=ge(t,S),P(V(ge(t,function(t){return P(t,ce,ce)})),function(){return t})})}function Y(t){return P(t,function(t){return V(ge(t,function(e,n){return P(e,function(e){return t[n]={state:"fulfilled",value:e},t[n]},function(e){return t[n]={state:"rejected",reason:e},t[n]})})).thenResolve(t)})}function U(t,e){return P(t,void 0,e)}function H(t,e){return P(t,void 0,void 0,e)}function X(t,e){return P(t,function(t){return P(e(),function(){return t})},function(t){return P(e(),function(){return x(t)})})}function K(t,e,n,a){var r=function(e){he(function(){if(i(e,t),!h.onerror)throw e;h.onerror(e)})},s=e||n||a?P(t,e,n,a):t;"object"==typeof process&&process&&process.domain&&(r=process.domain.bind(r)),U(s,r)}function Z(t,e,n){var i=u(),a=setTimeout(function(){i.reject(Error(n||"Timed out after "+e+" ms"))},e);return P(t,function(t){clearTimeout(a),i.resolve(t)},function(t){clearTimeout(a),i.reject(t)},i.notify),i.promise}function G(t,e){void 0===e&&(e=t,t=void 0);var n=u();return P(t,void 0,void 0,n.notify),setTimeout(function(){n.resolve(t)},e),n.promise}function J(t,e){var n=ue(e),i=u();return n.push(i.makeNodeResolver()),N(t,n).fail(i.reject),i.promise}function $(t){var e=ue(arguments,1),n=u();return e.push(n.makeNodeResolver()),N(t,e).fail(n.reject),n.promise}function Q(t){var e=ue(arguments,1);return function(){var n=e.concat(ue(arguments)),i=u();return n.push(i.makeNodeResolver()),N(t,n).fail(i.reject),i.promise}}function te(t,e){var n=ue(arguments,2);return function(){function i(){return t.apply(e,arguments)}var a=n.concat(ue(arguments)),r=u();return a.push(r.makeNodeResolver()),N(i,a).fail(r.reject),r.promise}}function ee(t,e,n){var i=ue(n||[]),a=u();return i.push(a.makeNodeResolver()),xe(t,e,i).fail(a.reject),a.promise}function ne(t,e){var n=ue(arguments,2),i=u();return n.push(i.makeNodeResolver()),xe(t,e,n).fail(i.reject),i.promise}function ie(t,e){return e?(t.then(function(t){he(function(){e(null,t)})},function(t){he(function(){e(t)})}),void 0):t}var ae=!1;try{throw Error()}catch(re){ae=!!re.stack}var se,le,oe=o(),ce=function(){},he=function(){function t(){for(;e.next;){e=e.next;var n=e.task;e.task=void 0;var a=e.domain;a&&(e.domain=void 0,a.enter());try{n()}catch(s){if(r)throw a&&a.exit(),setTimeout(t,0),a&&a.enter(),s;setTimeout(function(){throw s},0)}a&&a.exit()}i=!1}var e={task:void 0,next:null},n=e,i=!1,a=void 0,r=!1;if(he=function(t){n=n.next={task:t,domain:r&&process.domain,next:null},i||(i=!0,a())},"undefined"!=typeof process&&process.nextTick)r=!0,a=function(){process.nextTick(t)};else if("function"==typeof setImmediate)a="undefined"!=typeof window?setImmediate.bind(window,t):function(){setImmediate(t)};else if("undefined"!=typeof MessageChannel){var s=new MessageChannel;s.port1.onmessage=t,a=function(){s.port2.postMessage(0)}}else a=function(){setTimeout(t,0)};return he}(),ue=t(Array.prototype.slice),de=t(Array.prototype.reduce||function(t,e){var n=0,i=this.length;if(1===arguments.length)for(;;){if(n in this){e=this[n++];break}if(++n>=i)throw new TypeError}for(;i>n;n++)n in this&&(e=t(e,this[n],n));return e}),pe=t(Array.prototype.indexOf||function(t){for(var e=0;this.length>e;e++)if(this[e]===t)return e;return-1}),ge=t(Array.prototype.map||function(t,e){var n=this,i=[];return de(n,function(a,r,s){i.push(t.call(e,r,s,n))},void 0),i}),me=Object.create||function(t){function e(){}return e.prototype=t,new e},ve=t(Object.prototype.hasOwnProperty),fe=Object.keys||function(t){var e=[];for(var n in t)ve(t,n)&&e.push(n);return e},Le=t(Object.prototype.toString);le="undefined"!=typeof ReturnValue?ReturnValue:function(t){this.value=t};var _e;try{Function("(function* (){ yield 1; })"),_e=!0}catch(re){_e=!1}var Ce="From previous event:";h.nextTick=he,h.longStackSupport=!1,h.defer=u,u.prototype.makeNodeResolver=function(){var t=this;return function(e,n){e?t.reject(e):arguments.length>2?t.resolve(ue(arguments,1)):t.resolve(n)}},h.promise=d,h.makePromise=p,p.prototype.then=function(t,e,n){function a(e){try{return"function"==typeof t?t(e):e}catch(n){return x(n)}}function r(t){if("function"==typeof e){i(t,l);try{return e(t)}catch(n){return x(n)}}return x(t)}function s(t){return"function"==typeof n?n(t):t}var l=this,o=u(),c=!1;return he(function(){l.promiseDispatch(function(t){c||(c=!0,o.resolve(a(t)))},"when",[function(t){c||(c=!0,o.resolve(r(t)))}])}),l.promiseDispatch(void 0,"when",[void 0,function(t){var e,n=!1;try{e=s(t)}catch(i){if(n=!0,!h.onerror)throw i;h.onerror(i)}n||o.notify(e)}]),o.promise},p.prototype.thenResolve=function(t){return P(this,function(){return t})},p.prototype.thenReject=function(t){return P(this,function(){throw t})},de(["isFulfilled","isRejected","isPending","dispatch","when","spread","get","set","del","delete","post","send","mapply","invoke","mcall","keys","fapply","fcall","fbind","all","allResolved","timeout","delay","catch","finally","fail","fin","progress","done","nfcall","nfapply","nfbind","denodeify","nbind","npost","nsend","nmapply","ninvoke","nmcall","nodeify"],function(t,e){p.prototype[e]=function(){return h[e].apply(h,[this].concat(ue(arguments)))}},void 0),p.prototype.toSource=function(){return""+this},p.prototype.toString=function(){return"[object Promise]"},h.nearer=g,h.isPromise=m,h.isPromiseAlike=v,h.isPending=f,h.isFulfilled=L,h.isRejected=_;var we=[],ye=[],Me=!1,be=!0;h.resetUnhandledRejections=y,h.getUnhandledReasons=function(){return we.slice()},h.stopUnhandledRejectionTracking=function(){y(),"undefined"!=typeof process&&process.on&&process.removeListener("exit",w),be=!1},y(),h.reject=x,h.fulfill=z,h.resolve=S,h.master=T,h.when=P,h.spread=D,h.async=B,h.spawn=k,h["return"]=O,h.promised=A,h.dispatch=I,h.dispatcher=j,h.get=j("get"),h.set=j("set"),h["delete"]=h.del=j("delete");var xe=h.post=j("post");h.mapply=xe,h.send=R,h.invoke=R,h.mcall=R,h.fapply=N,h["try"]=F,h.fcall=F,h.fbind=q,h.keys=j("keys"),h.all=V,h.allResolved=c(W,"allResolved","allSettled"),h.allSettled=Y,h["catch"]=h.fail=U,h.progress=H,h["finally"]=h.fin=X,h.done=K,h.timeout=Z,h.delay=G,h.nfapply=J,h.nfcall=$,h.nfbind=Q,h.denodeify=h.nfbind,h.nbind=te,h.npost=ee,h.nmapply=ee,h.nsend=ne,h.ninvoke=h.nsend,h.nmcall=h.nsend,h.nodeify=ie;var ze=o();return h});
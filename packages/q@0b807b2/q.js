(function(e){if("function"==typeof bootstrap)bootstrap("promise",e);else if("object"==typeof exports)module.exports=e();else if("function"==typeof define&&define.amd)define(e);else if("undefined"!=typeof ses){if(!ses.ok())return;ses.makeQ=e}else Q=e()})(function(){"use strict";function e(e){var t=Function.call;return function(){return t.apply(e,arguments)}}function t(e){return e===Object(e)}function n(e){return"[object StopIteration]"===Lt(e)||e instanceof ot}function i(e,t){if(at&&t.stack&&"object"==typeof e&&null!==e&&e.stack&&-1===e.stack.indexOf(yt)){for(var n=[],i=t;i;i=i.source)i.stack&&n.unshift(i.stack);n.unshift(e.stack);var r=n.join("\n"+yt+"\n");e.stack=a(r)}}function a(e){for(var t=e.split("\n"),n=[],i=0;t.length>i;++i){var a=t[i];o(a)||r(a)||!a||n.push(a)}return n.join("\n")}function r(e){return-1!==e.indexOf("(module.js:")||-1!==e.indexOf("(node.js:")}function s(e){var t=/at .+ \((.+):(\d+):(?:\d+)\)$/.exec(e);if(t)return[t[1],Number(t[2])];var n=/at ([^ ]+):(\d+):(?:\d+)$/.exec(e);if(n)return[n[1],Number(n[2])];var i=/.*@(.+):(\d+)$/.exec(e);return i?[i[1],Number(i[2])]:void 0}function o(e){var t=s(e);if(!t)return!1;var n=t[0],i=t[1];return n===st&&i>=lt&&zt>=i}function l(){if(at)try{throw Error()}catch(e){var t=e.stack.split("\n"),n=t[0].indexOf("@")>0?t[1]:t[2],i=s(n);if(!i)return;return st=i[0],i[1]}}function c(e,t,n){return function(){return"undefined"!=typeof console&&"function"==typeof console.warn&&console.warn(t+" is deprecated, use "+n+" instead.",Error("").stack),e.apply(e,arguments)}}function u(e){return S(e)}function h(){function e(e){t=e,r.source=e,dt(n,function(t,n){ut(function(){e.promiseDispatch.apply(e,n)})},void 0),n=void 0,i=void 0}var t,n=[],i=[],a=mt(h.prototype),r=mt(p.prototype);if(r.promiseDispatch=function(e,a,r){var s=ht(arguments);n?(n.push(s),"when"===a&&r[1]&&i.push(r[1])):ut(function(){t.promiseDispatch.apply(t,s)})},r.valueOf=c(function(){if(n)return r;var e=g(t);return m(e)&&(t=e),e},"valueOf","inspect"),r.inspect=function(){return t?t.inspect():{state:"pending"}},u.longStackSupport&&at)try{throw Error()}catch(s){r.stack=s.stack.substring(s.stack.indexOf("\n")+1)}return a.promise=r,a.resolve=function(n){t||e(S(n))},a.fulfill=function(n){t||e(z(n))},a.reject=function(n){t||e(M(n))},a.notify=function(e){t||dt(i,function(t,n){ut(function(){n(e)})},void 0)},a}function d(e){if("function"!=typeof e)throw new TypeError("resolver must be a function.");var t=h();return F(e,t.resolve,t.reject,t.notify).fail(t.reject),t.promise}function p(e,t,n){void 0===t&&(t=function(e){return M(Error("Promise does not support operation: "+e))}),void 0===n&&(n=function(){return{state:"unknown"}});var i=mt(p.prototype);if(i.promiseDispatch=function(n,a,r){var s;try{s=e[a]?e[a].apply(i,r):t.call(i,a,r)}catch(o){s=M(o)}n&&n(s)},i.inspect=n,n){var a=n();"rejected"===a.state&&(i.exception=a.reason),i.valueOf=c(function(){var e=n();return"pending"===e.state||"rejected"===e.state?i:e.value})}return i}function g(e){if(m(e)){var t=e.inspect();if("fulfilled"===t.state)return t.value}return e}function m(e){return t(e)&&"function"==typeof e.promiseDispatch&&"function"==typeof e.inspect}function f(e){return t(e)&&"function"==typeof e.then}function v(e){return m(e)&&"pending"===e.inspect().state}function L(e){return!m(e)||"fulfilled"===e.inspect().state}function b(e){return m(e)&&"rejected"===e.inspect().state}function y(){wt||"undefined"==typeof window||window.Touch||!window.console||console.warn("[Q] Unhandled rejection reasons (should be empty):",Ct),wt=!0}function C(){for(var e=0;Ct.length>e;e++){var t=Ct[e];t&&t.stack!==void 0?console.warn("Unhandled rejection reason:",t.stack):console.warn("Unhandled rejection reason (no stack):",t)}}function _(){Ct.length=0,_t.length=0,wt=!1,xt||(xt=!0,"undefined"!=typeof process&&process.on&&process.on("exit",C))}function w(e,t){xt&&(_t.push(e),Ct.push(t),y())}function x(e){if(xt){var t=pt(_t,e);-1!==t&&(_t.splice(t,1),Ct.splice(t,1))}}function M(e){var t=p({when:function(t){return t&&x(this),t?t(e):this}},function(){return this},function(){return{state:"rejected",reason:e}});return w(t,e),t}function z(e){return p({when:function(){return e},get:function(t){return e[t]},set:function(t,n){e[t]=n},"delete":function(t){delete e[t]},post:function(t,n){return null===t||void 0===t?e.apply(void 0,n):e[t].apply(e,n)},apply:function(t,n){return e.apply(t,n)},keys:function(){return vt(e)}},void 0,function(){return{state:"fulfilled",value:e}})}function S(e){return m(e)?e:f(e)?E(e):z(e)}function E(e){var t=h();return ut(function(){try{e.then(t.resolve,t.reject,t.notify)}catch(n){t.reject(n)}}),t.promise}function k(e){return p({isDef:function(){}},function(t,n){return j(e,t,n)},function(){return S(e).inspect()})}function T(e,t,n,i){return u(e).then(t,n,i)}function O(e,t,n){return T(e,function(e){return V(e).then(function(e){return t.apply(void 0,e)},n)},n)}function P(e){return function(){function t(e,t){var s;if(bt){try{s=i[e](t)}catch(o){return M(o)}return s.done?s.value:T(s.value,a,r)}try{s=i[e](t)}catch(o){return n(o)?o.value:M(o)}return T(s,a,r)}var i=e.apply(this,arguments),a=t.bind(t,"send"),r=t.bind(t,"throw");return a()}}function B(e){u.done(u.async(e)())}function D(e){throw new ot(e)}function A(e){return function(){return O([this,V(arguments)],function(t,n){return e.apply(t,n)})}}function j(e,t,n){var i=h();return ut(function(){S(e).promiseDispatch(i.resolve,t,n)}),i.promise}function I(e){return function(t){var n=ht(arguments,1);return j(t,e,n)}}function R(e,t){var n=ht(arguments,2);return Mt(e,t,n)}function N(e,t){return j(e,"apply",[void 0,t])}function F(e){var t=ht(arguments,1);return N(e,t)}function q(e){var t=ht(arguments,1);return function(){var n=t.concat(ht(arguments));return j(e,"apply",[this,n])}}function V(e){return T(e,function(e){var t=0,n=h();return dt(e,function(i,a,r){var s;m(a)&&"fulfilled"===(s=a.inspect()).state?e[r]=s.value:(++t,T(a,function(i){e[r]=i,0===--t&&n.resolve(e)},n.reject))},void 0),0===t&&n.resolve(e),n.promise})}function W(e){return T(e,function(e){return e=gt(e,S),T(V(gt(e,function(e){return T(e,ct,ct)})),function(){return e})})}function H(e){return T(e,function(e){return V(gt(e,function(t,n){return T(t,function(t){return e[n]={state:"fulfilled",value:t},e[n]},function(t){return e[n]={state:"rejected",reason:t},e[n]})})).thenResolve(e)})}function U(e,t){return T(e,void 0,t)}function Y(e,t){return T(e,void 0,void 0,t)}function G(e,t){return T(e,function(e){return T(t(),function(){return e})},function(e){return T(t(),function(){return M(e)})})}function K(e,t,n,a){var r=function(t){ut(function(){if(i(t,e),!u.onerror)throw t;u.onerror(t)})},s=t||n||a?T(e,t,n,a):e;"object"==typeof process&&process&&process.domain&&(r=process.domain.bind(r)),U(s,r)}function X(e,t,n){var i=h(),a=setTimeout(function(){i.reject(Error(n||"Timed out after "+t+" ms"))},t);return T(e,function(e){clearTimeout(a),i.resolve(e)},function(e){clearTimeout(a),i.reject(e)},i.notify),i.promise}function Z(e,t){void 0===t&&(t=e,e=void 0);var n=h();return T(e,void 0,void 0,n.notify),setTimeout(function(){n.resolve(e)},t),n.promise}function J(e,t){var n=ht(t),i=h();return n.push(i.makeNodeResolver()),N(e,n).fail(i.reject),i.promise}function $(e){var t=ht(arguments,1),n=h();return t.push(n.makeNodeResolver()),N(e,t).fail(n.reject),n.promise}function Q(e){var t=ht(arguments,1);return function(){var n=t.concat(ht(arguments)),i=h();return n.push(i.makeNodeResolver()),N(e,n).fail(i.reject),i.promise}}function et(e,t){var n=ht(arguments,2);return function(){function i(){return e.apply(t,arguments)}var a=n.concat(ht(arguments)),r=h();return a.push(r.makeNodeResolver()),N(i,a).fail(r.reject),r.promise}}function tt(e,t,n){var i=ht(n||[]),a=h();return i.push(a.makeNodeResolver()),Mt(e,t,i).fail(a.reject),a.promise}function nt(e,t){var n=ht(arguments,2),i=h();return n.push(i.makeNodeResolver()),Mt(e,t,n).fail(i.reject),i.promise}function it(e,t){return t?(e.then(function(e){ut(function(){t(null,e)})},function(e){ut(function(){t(e)})}),void 0):e}var at=!1;try{throw Error()}catch(rt){at=!!rt.stack}var st,ot,lt=l(),ct=function(){},ut=function(){function e(){for(;t.next;){t=t.next;var n=t.task;t.task=void 0;var a=t.domain;a&&(t.domain=void 0,a.enter());try{n()}catch(s){if(r)throw a&&a.exit(),setTimeout(e,0),a&&a.enter(),s;setTimeout(function(){throw s},0)}a&&a.exit()}i=!1}var t={task:void 0,next:null},n=t,i=!1,a=void 0,r=!1;if(ut=function(e){n=n.next={task:e,domain:r&&process.domain,next:null},i||(i=!0,a())},"undefined"!=typeof process&&process.nextTick)r=!0,a=function(){process.nextTick(e)};else if("function"==typeof setImmediate)a="undefined"!=typeof window?setImmediate.bind(window,e):function(){setImmediate(e)};else if("undefined"!=typeof MessageChannel){var s=new MessageChannel;s.port1.onmessage=e,a=function(){s.port2.postMessage(0)}}else a=function(){setTimeout(e,0)};return ut}(),ht=e(Array.prototype.slice),dt=e(Array.prototype.reduce||function(e,t){var n=0,i=this.length;if(1===arguments.length)for(;;){if(n in this){t=this[n++];break}if(++n>=i)throw new TypeError}for(;i>n;n++)n in this&&(t=e(t,this[n],n));return t}),pt=e(Array.prototype.indexOf||function(e){for(var t=0;this.length>t;t++)if(this[t]===e)return t;return-1}),gt=e(Array.prototype.map||function(e,t){var n=this,i=[];return dt(n,function(a,r,s){i.push(e.call(t,r,s,n))},void 0),i}),mt=Object.create||function(e){function t(){}return t.prototype=e,new t},ft=e(Object.prototype.hasOwnProperty),vt=Object.keys||function(e){var t=[];for(var n in e)ft(e,n)&&t.push(n);return t},Lt=e(Object.prototype.toString);ot="undefined"!=typeof ReturnValue?ReturnValue:function(e){this.value=e};var bt;try{Function("(function* (){ yield 1; })"),bt=!0}catch(rt){bt=!1}var yt="From previous event:";u.nextTick=ut,u.longStackSupport=!1,u.defer=h,h.prototype.makeNodeResolver=function(){var e=this;return function(t,n){t?e.reject(t):arguments.length>2?e.resolve(ht(arguments,1)):e.resolve(n)}},u.promise=d,u.makePromise=p,p.prototype.then=function(e,t,n){function a(t){try{return"function"==typeof e?e(t):t}catch(n){return M(n)}}function r(e){if("function"==typeof t){i(e,o);try{return t(e)}catch(n){return M(n)}}return M(e)}function s(e){return"function"==typeof n?n(e):e}var o=this,l=h(),c=!1;return ut(function(){o.promiseDispatch(function(e){c||(c=!0,l.resolve(a(e)))},"when",[function(e){c||(c=!0,l.resolve(r(e)))}])}),o.promiseDispatch(void 0,"when",[void 0,function(e){var t,n=!1;try{t=s(e)}catch(i){if(n=!0,!u.onerror)throw i;u.onerror(i)}n||l.notify(t)}]),l.promise},p.prototype.thenResolve=function(e){return T(this,function(){return e})},p.prototype.thenReject=function(e){return T(this,function(){throw e})},dt(["isFulfilled","isRejected","isPending","dispatch","when","spread","get","set","del","delete","post","send","mapply","invoke","mcall","keys","fapply","fcall","fbind","all","allResolved","timeout","delay","catch","finally","fail","fin","progress","done","nfcall","nfapply","nfbind","denodeify","nbind","npost","nsend","nmapply","ninvoke","nmcall","nodeify"],function(e,t){p.prototype[t]=function(){return u[t].apply(u,[this].concat(ht(arguments)))}},void 0),p.prototype.toSource=function(){return""+this},p.prototype.toString=function(){return"[object Promise]"},u.nearer=g,u.isPromise=m,u.isPromiseAlike=f,u.isPending=v,u.isFulfilled=L,u.isRejected=b;var Ct=[],_t=[],wt=!1,xt=!0;u.resetUnhandledRejections=_,u.getUnhandledReasons=function(){return Ct.slice()},u.stopUnhandledRejectionTracking=function(){_(),"undefined"!=typeof process&&process.on&&process.removeListener("exit",C),xt=!1},_(),u.reject=M,u.fulfill=z,u.resolve=S,u.master=k,u.when=T,u.spread=O,u.async=P,u.spawn=B,u["return"]=D,u.promised=A,u.dispatch=j,u.dispatcher=I,u.get=I("get"),u.set=I("set"),u["delete"]=u.del=I("delete");var Mt=u.post=I("post");u.mapply=Mt,u.send=R,u.invoke=R,u.mcall=R,u.fapply=N,u["try"]=F,u.fcall=F,u.fbind=q,u.keys=I("keys"),u.all=V,u.allResolved=c(W,"allResolved","allSettled"),u.allSettled=H,u["catch"]=u.fail=U,u.progress=Y,u["finally"]=u.fin=G,u.done=K,u.timeout=X,u.delay=Z,u.nfapply=J,u.nfcall=$,u.nfbind=Q,u.denodeify=u.nfbind,u.nbind=et,u.npost=tt,u.nmapply=tt,u.nsend=nt,u.ninvoke=u.nsend,u.nmcall=u.nsend,u.nodeify=it;var zt=l();return u});
(function(t){function e(t){this._handlers=t,this._enteredObjects={}}Object.defineProperties(e.prototype,{_handlers:{value:null,writable:!0},_enteredObjects:{value:null,writable:!0},_isObjectEntered:{value:function(t){return Object.hash(t)in this._enteredObjects}},_markObjectAsEntered:{value:function(t){this._enteredObjects[Object.hash(t)]=!0}},visit:{value:function(t,e){this._visitValue(t,e)},enumerable:!0},_getTypeOf:{value:function(t){return Array.isArray(t)?"array":RegExp.isRegExp(t)?"regexp":null===t?"null":"object"==typeof t||"function"==typeof t?this._getObjectType(t):typeof t}},_getObjectType:{value:function(t){var e,n=this._handlers;return"function"==typeof n.getTypeOf&&(e=n.getTypeOf(t)),e===void 0?typeof t:e}},_visitValue:{value:function(t,e){var n=this._getTypeOf(t);"object"===n?this._visitObject(t,e):"array"===n?this._visitArray(t,e):"regexp"===n?this._visitRegExp(t,e):"number"===n?this._visitNumber(t,e):"string"===n?this._visitString(t,e):"boolean"===n?this._visitBoolean(t,e):"null"===n?this._visitNull(e):"undefined"===n?this._visitUndefined(e):this._visitCustomType(n,t,e)}},_visitCustomType:{value:function(t,e,n){this._callVisitorMethod("visit"+t,e,n)}},_enterCustomObject:{value:function(t,e,n){this._callVisitorMethod("enter"+t,e,n),this._callVisitorMethod("exit"+t,e,n)}},_visitObject:{value:function(t,e){var n;this._isObjectEntered(t)?this._callVisitorMethod("visitObject",t,e):(n=this._callVisitorMethod("willEnterObject",t,e),n!==!1&&(this._markObjectAsEntered(t),this._enterObject(t,e)))}},_enterObject:{value:function(t,e){var n,i=Object.keys(t);this._callVisitorMethod("enterObject",t,e);for(var a=0,r=i.length;r>a;a++)n=i[a],this._visitValue(t[n],n);this._callVisitorMethod("exitObject",t,e)}},_visitArray:{value:function(t,e){var n;this._isObjectEntered(t)?this._callVisitorMethod("visitArray",t,e):(n=this._callVisitorMethod("willEnterArray",t,e),n!==!1&&(this._markObjectAsEntered(t),this._enterArray(t,e)))}},_enterArray:{value:function(t,e){this._callVisitorMethod("enterArray",t,e);for(var n=0,i=t.length;i>n;n++)this._visitValue(t[n],""+n);this._callVisitorMethod("exitArray",t,e)}},_visitRegExp:{value:function(t,e){this._callVisitorMethod("visitRegExp",t,e)}},_visitString:{value:function(t,e){this._callVisitorMethod("visitString",t,e)}},_visitNumber:{value:function(t,e){this._callVisitorMethod("visitNumber",t,e)}},_visitBoolean:{value:function(t,e){this._callVisitorMethod("visitBoolean",t,e)}},_visitNull:{value:function(t){this._callVisitorMethod("visitNull",t)}},_visitUndefined:{value:function(t){this._callVisitorMethod("visitUndefined",t)}},_callVisitorMethod:{value:function(t){var e,n=this._handlers;return"function"==typeof n[t]?(e=Array.prototype.slice.call(arguments,1),e.unshift(this),n[t].apply(n,e)):void 0}}}),Array.isArray||(Array.isArray=function(t){return"[object Array]"===Object.prototype.toString.call(t)}),RegExp.isRegExp||(RegExp.isRegExp=function(t){return"[object RegExp]"===Object.prototype.toString.call(t)}),t.Malker=e,t.visit=function(t,n){var i=new e(n);i.visit(t)}})(exports);
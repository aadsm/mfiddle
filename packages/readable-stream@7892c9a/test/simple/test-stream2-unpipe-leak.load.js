montageDefine("7892c9a","test/simple/test-stream2-unpipe-leak",{dependencies:["../common.js","assert","../../readable","util"],factory:function(e){function t(){r.Writable.call(this)}function n(){r.Readable.call(this,{highWaterMark:65536})}e("../common.js");var i=e("assert"),r=e("../../readable"),a=new Buffer("hallo"),s=e("util");s.inherits(t,r.Writable),t.prototype._write=function(e,t,n){n(null)};var o=new t;s.inherits(n,r.Readable),n.prototype._read=function(){this.push(a)};for(var l=new n,c=0;10>c;c++)l.pipe(o),l.unpipe(o);i.equal(l.listeners("end").length,0),i.equal(l.listeners("readable").length,0),i.equal(o.listeners("unpipe").length,0),i.equal(o.listeners("drain").length,0),i.equal(o.listeners("error").length,0),i.equal(o.listeners("close").length,0),i.equal(o.listeners("finish").length,0),console.error(l._readableState),process.on("exit",function(){i(l._readableState.length>=l._readableState.highWaterMark),l._readableState.buffer.length=0,console.error(l._readableState)})}});
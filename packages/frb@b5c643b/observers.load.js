montageDefine("b5c643b","observers",{dependencies:["collections/shim","collections/listen/property-changes","collections/listen/array-changes","collections/sorted-array","collections/map","collections/set","collections/heap","./scope","./operators","./parse","./compile-observer","./merge"],factory:function(t,e){function n(t){return function(e){return e(t)||Function.noop}}function i(t,e){return t(e.value)||Function.noop}function r(t,e){return t(e.parameters)||Function.noop}function a(t){return function(e,n){return e(n.document.getElementById(t))||Function.noop}}function s(t,e){return function(n,i){var r=i.components,a=r.getObjectByLabel||r.getComponentByLabel,s=a.call(r,t);return e.component=s,n(s)||Function.noop}}function o(t,e,n,i){function r(t,e,i){a(),a=n(t,e,i)||Function.noop}if(null==t)return n();var a=Function.noop;return he.addOwnPropertyChangeListener(t,e,r,i.beforeChange),r(t[e],e,t),ue(function(){a(),he.removeOwnPropertyChangeListener(t,e,r,i.beforeChange)})}function l(t,e){return function(n,i){return e(ce(function(e){return null==e?n():t(ce(function(t){return null==t?n():t.observeProperty?t.observeProperty(e,n,i):Le(t,e,n,i)}),i)}),i)}}function c(t,e,n,i){function r(t,i,r){s(e,i)&&(a(),a=n(t,e,r)||Function.noop)}var a=Function.noop,s=t.contentEquals||Object.equals;return r(t.get(e),e,t),t.addMapChangeListener(r,i.beforeChange),ue(function(){a(),t.removeMapChangeListener(r)})}function u(t,e){return function(n,i){return t(ce(function(t){return t?e(ce(function(e){return null==e?n():t.observeGet?t.observeGet(e,n,i):ye(t,e,n,i)}),i):n()}),i)}}function h(t,e){return function(n,i){return n=oe(n),e(ce(function(e){return t(ce(function(t){return t?H(t,function(){return n((t.has||t.contains).call(t,e))},i):n()}),i)}),i)}}function p(t){return function(e,n){for(var i=Array(t.length),r=0;t.length>r;r++)i[r]=void 0;var a=t.map(function(t,e){return t(function(t){i.set(e,t)},n)}),s=e(i)||Function.noop;return ue(function(){s(),le(a)})}}function d(t){return function(e,n){var i={},r={};for(var a in t)(function(t,e){i[t]=e(function(e){r[t]=e},n)})(a,t[a]);var s=e(r)||Function.noop;return function(){s();for(var t in i)i[t]()}}}function g(){return p(Array.prototype.slice.call(arguments))}function m(t){return function(){var e=p(Array.prototype.slice.call(arguments)),n=U(e);return function(e,i){return n(ce(function(n){return n.every(ve.defined)?e(t.apply(void 0,n)):e()}),i)}}}function f(t){var e=t.slice(0,1).toUpperCase()+t.slice(1),n="make"+e+"Observer",i="observe"+e;return function(){var e=arguments[0],r=Array.prototype.slice.call(arguments,1),a=r.map(function(t){return function(e,n){return t(ce(e),n)}}),s=p(r),o=U(s);return function(r,s){return e(ce(function(e){return e?e[n]?e[n].apply(e,a)(r,s):e[i]?e[i](r,s):o(ce(function(n){if(!n.every(ve.defined))return r();if(e[t])return r(e[t].apply(e,n));throw Error("Object has no method "+JSON.stringify(t)+": "+e)}),s):r()}),s)}}}function v(t){return function(e,n){return t(ce(function(t){return e(!t)}),n)}}function L(t,e){return function(n,i){return t(ce(function(t){return t?e(n,i):n(t)}),i)}}function y(t,e){return function(n,i){return t(ce(function(t){return t?n(t):e(n,i)}),i)}}function C(t,e,n){return function(i,r){return t(ce(function(t){return null==t?i():t?e(i,r):n(i,r)}),r)}}function b(t){return function(e,n){return t(ce(function(t){return e(null!=t)}),n)}}function _(t,e){return function(n,i){return t(ce(function(t){return null==t?e(n,i):n(t)}),i)}}function w(t,e){return function(n,i){return t(ce(function(t){function r(e){for(;t.length>e;e++)o[e].index=e}function a(t,n,a){o.swap(a,n.length,t.map(function(t,e){return{index:a+e}})),r(a+t.length);var c,u=[];le(l.swap(a,n.length,t.map(function(t,n){var r=o[a+n];return e(ce(function(t){c?s.set(r.index,t):u[n]=t}),fe.nest(i,t))}))),c=!0,s.swap(a,n.length,u)}if(!t)return n();var s=[],o=[],l=[],c=H(t,a,i),u=n(s,t)||Function.noop;return ue(function(){u(),le(l),c()})}),i)}}function x(t,e){var n=w(t,e);return function(t,e){return n(ce(function(n,i){function r(t){for(;n.length>t;t++)l[t+1]=l[t]+n[t]}function a(t,e,n){var a=i.slice(n,n+t.length),o=e.map(Boolean).sum(),c=a.filter(function(e,n){return t[n]}),u=l[n],h=s.slice(u,u+o);(h.length!==c.length||h.every(function(t,e){return t!==c[e]}))&&s.swap(u,o,c),r(u)}if(!i)return t();var s=[],o=[],l=[0],c=H(n,a,e),u=t(s)||Function.noop;return ue(function(){u(),le(o),c()})}),e)}}function M(t,e){var n=z(e),i=w(t,n),r=function(t,e){return i(ce(function(n){function i(t,e){a.addEach(t),a.deleteEach(e)}if(!n)return t();var r=[],a=pe(r,function(t,e){return Object.equals(t[1],e[1])},function(t,e){return Object.compare(t[1],e[1])}),s=H(n,i,e),o=t(r)||Function.noop;return function(){o(),s()}}),e)};return Ce(r,$)}function z(t){return function(e,n){return t(ce(function(t){return e([n.value,t])||Function.noop}),n)}}function S(t){return function(e,n){return t(ce(function(t){function i(t,e,n){var i=r.length-n-e.length;r.swap(i,e.length,t.reversed())}if(!t)return e();var r=[],a=H(t,i,n),s=e(r);return ue(function(){s(),a()})}),n)}}function E(t){return function(e,n){return t(ce(function(t){function i(e){for(var n=e;t.length>n;n++)l[n].index=n,o[n+1]=t[n]?o[n]+t[n].length:o[n]}function r(t,e,r){var c=o[r],u=o[r+e.length],h=u-c;a.swap(c,h,[]),l.swap(r,e.length,t.map(function(){return{index:null}})),i(r),le(s.swap(r,e.length,t.map(function(t,e){function s(t,e,n){i(c.index);var r=o[c.index]+n,s=o[c.index]+n+e.length,l=s-r;a.swap(r,l,t)}var c=l[r+e];return H(t,s,n)})))}if(!t)return e();var a=[],s=[],o=[0],l=[],c=H(t,r,n),u=e(a)||Function.noop;return ue(function(){u(),le(s),c()})}),n)}}function k(){return _e(p(Array.prototype.slice.call(arguments)))}function P(t,e){var n=be(t,e),i=l(n,we);return ne(i,Boolean)}function O(t,e){var n=ne(e,ve.not),i=be(t,n),r=l(i,we);return ne(r,ve.not)}function T(t,e){var n=D(t,e);return xe(n)}function D(t,e){var n=z(e),i=w(t,n);return function(t,e){return i(ce(function(n,i){function r(t,e){var n=ge();e.forEach(function(t){var e=a.get(t[1]);e["delete"](t[0]),n.add(t[1])}),t.forEach(function(t){a.has(t[1])||a.set(t[1],i.constructClone());var e=a.get(t[1]);e.add(t[0])}),n.forEach(function(t){var e=a.get(t);0===e.length&&a["delete"](t)})}if(!n)return t();var a=de(),s=H(n,r,e),o=t(a)||Function.noop;return function(){s(),o()}}),e)}}function B(t,e,n){function i(t,e){return Object.compare(t[1],e[1])*n}function r(t,e){return Object.equals(t[1],e[1])}var a=z(e),s=w(t,a);return function(t,e){return s(ce(function(n){function a(t,e){o.addEach(t),o.deleteEach(e)}function s(e,n){return 0===n?e?t(e[0]):t():void 0}if(!n)return t();var o=new me(null,r,i),l=H(n,a,e),c=K(o,s,e);return function(){l(),c()}}),e)}}function A(t,e){return B(t,e,1)}function j(t,e){return B(t,e,-1)}function I(t){return function(e){return function(n,i){return n=oe(n),e(ce(function(e){if(!e)return n();var r=t(e,n);return H(e,function(t,e,i){return n(r(t,e,i))},i)}),i)}}}function R(t,e,n){return function(i,r){return t(ce(function(t){return t?n(ce(function(n){return null==n?i():e(ce(function(e){function a(i,r,a){var o=i.length-r.length;e>a&&0>o&&n>o?(s.swap(s.length,0,t.slice(e+n+o,e+n)),s.splice(0,-o)):e>a&&o>0&&n>o?(s.swap(0,0,t.slice(e,e+o)),s.splice(s.length-o,o)):a>=e&&0>o&&e+n>a?(s.swap(s.length,0,t.slice(e+n+o,e+n)),s.splice(a-e,-o)):a>=e&&o>0&&e+n>a?(s.swap(a-e,0,t.slice(a,a+o)),s.splice(s.length-o,o)):e+n>a&&s.swap(0,s.length,t.slice(e,e+n))}if(null==e)return i();var s=[],o=H(t,a,r),l=i(s)||Function.noop;return ue(function(){l(),o()})}),r)}),r):i()}),r)}}function N(t){return function(e,n){return t(ce(function(t){function i(t){for(;a.length>t;t++)a[t].set(0,t)}function r(t,e,n){a.swap(n,e.length,t.map(function(t,e){return[n+e,t]})),i(n+t.length)}if(!t)return e();var a=[],s=H(t,r,n),o=e(a)||Function.noop;return function(){o(),s()}}),n)}}function F(t){return function(e,n){var i=[],r=e(i)||Function.noop,a=t(function(t){if(t>>>=0,null==t)i.clear();else if(t>i.length){for(var e=[],n=i.length;t>n;n++)e.push(n);i.swap(i.length,0,e)}else i.length>t&&i.splice(t,i.length)},n);return function(){r(),a()}}}function q(t,e){return function(n,i){return e(function(e){var r=RegExp("^"+RegExp.escape(e));return t(function(t){return n(r.test(t))||Function.noop},i)},i)}}function W(t,e){return function(n,i){return e(function(e){var r=RegExp(RegExp.escape(e)+"$");return t(function(t){return n(r.test(t))||Function.noop},i)},i)}}function V(t,e){return function(n,i){return e(function(e){var r=RegExp(RegExp.escape(e));return t(function(t){return n(r.test(t))||Function.noop},i)},i)}}function H(t,e,n){function i(t,n,i){r(),r=e(t,n,i)||Function.noop}if(t){var r=Function.noop;if(!t.toArray)throw Error("Can't observe range changes on "+t+" because it has no toArray method");if(!t.addRangeChangeListener)throw Error("Can't observe range changes on "+t);i(t.toArray(),[],0);var a=t.addRangeChangeListener(i,n.beforeChange);return ue(function(){r(),a()})}}function U(t){return function(e,n){return t(ce(function(t){return t&&t.addRangeChangeListener?H(t,function(){return e(t)},n):e(t)}),n)}}function Y(t){return function(e,n){return t(ce(function(t){return t&&t.addMapChangeListener?K(t,function(){return e(t)},n):e(t)}),n)}}function K(t,e,n){function i(t,n,i){var a=r.get(n)||Function.noop;a(),a=e(t,n,i)||Function.noop,r.set(n,a)}var r=de();t.forEach(i);var a=t.addMapChangeListener(i,n.beforeChange);return ue(function(){r.forEach(function(t){t()}),a()})}function G(t){return function(e,n){return t(ce(function(t){return t?X(t,e,n):e()}),n)}}function X(t,e,n){function i(t,e){var n,i;a.has(e)?null==t?(n=a.get(e),a["delete"](e),i=r.indexOf(n),r.splice(i,1)):(n=a.get(e),n.set(1,t)):(n=[e,t],a.set(e,n),r.push(n))}var r=[],a=de(),s=e(r)||Function.noop,o=K(t,i,n);return ue(function(){s(),o()})}function Z(t){var e=xe(t);return Ce(e,$)}function $(t,e){return e.value?t(e.value[0])||Function.noop:t()}function J(t){var e=xe(t);return Ce(e,Q)}function Q(t,e){return e.value?t(e.value[1])||Function.noop:t()}function te(t){return function(e,n){var i=de(),r=e(i)||Function.noop,a=t(ce(function(t){if(i.clear(),t&&!t.addRangeChangeListener){var e=Object.keys(t).map(function(e){return Le(t,e,ce(function(t){i.set(e,t)}),n)});return function(){le(e)}}}),n);return function(){r(),a()}}}function ee(t){return function(e,n){return t(e,n.parent||new fe)}}function ne(t,e,n){return function(i,r){return i=oe(i),t(ce(function(t){return i(e.call(n,t))}),r)}}function ie(t,e,n){return function(i,r){return i=oe(i),t(ce(function(t){return t&&t.every(ve.defined)?i(e.apply(n,t)):void 0}),r)}}function re(e,n){var i=t("./parse"),r=t("./compile-observer");return function(t,a){return t=oe(t),n(ce(function(n){if(null==n)return t();var s,o;try{s=i(n),o=r(s)}catch(l){return t()}return e(ce(function(e){return o(t,fe.nest(a,e))}),a)}),a)}}function ae(t,e){return function(n,i){return t(ce(function(t){return e(ce(function(t){return n(t)}),fe.nest(i,t))}),i)}}function se(t){return function(){var e=t.apply(this,arguments);return function(t,n){var i=[],r=e(ce(function(t){function e(t,e,n){i.swap(n,e.length,t)}if(t){Me(i,t);var r=t.addRangeChangeListener(e,n.beforeChange);return ue(r)}i.clear()}),n),a=t(i)||Function.noop;return ue(function(){r(),a()})}}}function oe(t){var e;return function(n){if(n!==e){var i=t.apply(this,arguments);return e=n,i}}}function le(t){t.forEach(function(t){t&&t()})}function ce(t){var e=Function.noop;return function(){return e(),e=t.apply(this,arguments)||Function.noop,function(){e()}}}function ue(t){var e;return function(){return e?Function.noop:(e=!0,t.apply(this,arguments))}}t("collections/shim");var he=t("collections/listen/property-changes");t("collections/listen/array-changes");var pe=t("collections/sorted-array"),de=t("collections/map"),ge=t("collections/set"),me=t("collections/heap"),fe=t("./scope"),ve=t("./operators");e.makeLiteralObserver=n,e.observeValue=i,e.observeParameters=r,e.makeElementObserver=a,e.makeComponentObserver=s,e.observeProperty=o;var Le=o;e.makePropertyObserver=l,e.observeKey=c,e.observeGet=c;var ye=c;e.makeGetObserver=u,e.makeHasObserver=h,e.makeObserversObserver=p,e.makeRecordObserver=d,e.makeObjectObserver=d,e.makeTupleObserver=g,e.makeArrayObserver=g,e.makeOperatorObserverMaker=m,e.makeMethodObserverMaker=f,e.makeNotObserver=v,e.makeAndObserver=L,e.makeOrObserver=y,e.makeConditionalObserver=C,e.makeDefinedObserver=b,e.makeDefaultObserver=_;var Ce=e.makeMapBlockObserver=se(w),be=e.makeFilterBlockObserver=se(x);e.makeSortedBlockObserver=M,e.makeReversedObserver=se(S);var _e=e.makeFlattenObserver=se(E);e.makeConcatObserver=k,e.makeSomeBlockObserver=P,e.makeEveryBlockObserver=O,e.makeGroupBlockObserver=T,e.makeGroupMapBlockObserver=D,e.makeMaxBlockObserver=A,e.makeMinBlockObserver=j;var we=n("length");e.makeSumObserver=I(function(){var t=0;return function(e,n){return t+=e.sum()-n.sum()}}),e.makeAverageObserver=I(function(){var t=0,e=0;return function(n,i){return t+=n.sum()-i.sum(),e+=n.length-i.length,t/e}}),e.makeViewObserver=se(R),e.makeEnumerateObserver=se(N),e.makeEnumerationObserver=e.makeEnumerateObserver,e.makeRangeObserver=F,e.makeStartsWithObserver=q,e.makeEndsWithObserver=W,e.makeContainsObserver=V,e.observeRangeChange=H,e.makeRangeContentObserver=U,e.makeMapContentObserver=Y,e.observeMapChange=K;var xe=e.makeItemsObserver=se(G);e.observeItems=X,e.makeKeysObserver=Z,e.observeItemKey=$,e.makeValuesObserver=J,e.observeItemValue=Q,e.makeToMapObserver=te,e.makeParentObserver=ee,e.makeConverterObserver=ne,e.makeComputerObserver=ie,e.makePathObserver=re,e.makeExpressionObserver=re,e.makeWithObserver=ae,e.makeAsArrayObserver=se(Function.identity);var Me=t("./merge").merge;e.makeUniq=oe,e.cancelEach=le,e.autoCancelPrevious=ce,e.once=ue}});
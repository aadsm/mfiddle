montageDefine("c081c7d","test/simple/test-stream2-large-read-stall",{dependencies:["../common.js","assert","../../readable"],factory:function(e){function t(){if(!(h>a)){if(h++===a)return console.error("   push(EOF)"),l.push(null);console.error("   push #%d",h),l.push(new Buffer(r))&&setTimeout(t)}}e("../common.js");var n=e("assert"),i=100,r=20,a=1e3,s=50,o=e("../../readable").Readable,l=new o({highWaterMark:s}),c=l._readableState;l._read=t,l.on("readable",function(){console.error(">> readable");do{console.error("  > read(%d)",i);var e=l.read(i);console.error("  < %j (%d remain)",e&&e.length,c.length)}while(e&&e.length===i);console.error("<< after read()",e&&e.length,c.needReadable,c.length)});var u=!1;l.on("end",function(){u=!0,console.error("end")});var h=0;l.read(0),process.on("exit",function(){n.equal(h,a+1),n(u)})}});
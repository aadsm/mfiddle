montageDefine("c081c7d","test/simple/test-stream2-unpipe-leak",{dependencies:["../common.js","assert","../../readable","util"],factory:function(e){function t(){i.Writable.call(this)}function n(){i.Readable.call(this,{highWaterMark:65536})}e("../common.js");var r=e("assert"),i=e("../../readable"),a=new Buffer("hallo"),s=e("util");s.inherits(t,i.Writable),t.prototype._write=function(e,t,n){n(null)};var o=new t;s.inherits(n,i.Readable),n.prototype._read=function(){this.push(a)};for(var l=new n,c=0;10>c;c++)l.pipe(o),l.unpipe(o);r.equal(l.listeners("end").length,0),r.equal(l.listeners("readable").length,0),r.equal(o.listeners("unpipe").length,0),r.equal(o.listeners("drain").length,0),r.equal(o.listeners("error").length,0),r.equal(o.listeners("close").length,0),r.equal(o.listeners("finish").length,0),console.error(l._readableState),process.on("exit",function(){r(l._readableState.length>=l._readableState.highWaterMark),l._readableState.buffer.length=0,console.error(l._readableState)})}});